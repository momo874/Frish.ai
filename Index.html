<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Chat Studio Pro</title>

<!-- Puter script -->
<script src="https://js.puter.com/v2/"></script>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', system-ui, -apple-system, sans-serif; }
:root {
  --sidebar-width:280px; --primary:#10a37f; --primary-hover:#0d8c6d;
  --bg-main:#343541; --bg-sidebar:#202123; --bg-chat:#444654;
  --text:#ececf1; --text-secondary:#8e8ea0; --border:#565869;
}
body { display:flex; height:100vh; background:var(--bg-main); color:var(--text); overflow:hidden; }
body.image-mode { background:linear-gradient(135deg,#667eea 0%,#764ba2 25%,#f093fb 50%,#4facfe 75%,#00f2fe 100%); background-size:400% 400%; animation:gradientShift 15s ease infinite; }
@keyframes gradientShift{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}

/* Sidebar */
.sidebar { width:var(--sidebar-width); background:var(--bg-sidebar); display:flex; flex-direction:column; position:fixed; left:0; top:0; height:100%; z-index:1000; transition: transform 0.3s; box-shadow:2px 0 10px rgba(0,0,0,0.3);}
.sidebar.collapsed { transform:translateX(-100%);}
.sidebar-header { padding:16px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:12px;}
.logo { font-size:24px; font-weight:700; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.new-chat { background:linear-gradient(135deg,var(--primary) 0%,var(--primary-hover) 100%); padding:12px 16px; border-radius:8px; text-align:center; cursor:pointer; margin:12px; display:flex; align-items:center; justify-content:center; gap:8px; font-weight:600; transition:all 0.3s; box-shadow:0 2px 8px rgba(16,163,127,0.3);}
.new-chat:hover{transform:translateY(-2px); box-shadow:0 4px 12px rgba(16,163,127,0.4);}
.history { flex:1; overflow-y:auto; padding:8px; }
.history::-webkit-scrollbar { width:6px; } .history::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
.history-item { padding:10px 12px; cursor:pointer; border-radius:8px; font-size:14px; margin-bottom:6px; display:flex; justify-content:space-between; align-items:center; position:relative; transition:all 0.2s; }
.history-item:hover { background:#2a2b32; } 
.delete-chat { opacity:0; transition:0.2s; padding:4px 8px; border-radius:4px; background:rgba(255,77,77,0.2); color:#ff4d4d; font-size:12px;}
.history-item:hover .delete-chat { opacity:1;}

/* Main */
.main { flex:1; margin-left:var(--sidebar-width); display:flex; flex-direction:column; background:var(--bg-main); width:calc(100% - var(--sidebar-width)); transition:all 0.3s;}
.main.sidebar-collapsed { margin-left:0; width:100%; }

/* Topbar */
.topbar { display:flex; justify-content:space-between; align-items:center; padding:12px 20px; border-bottom:1px solid var(--border); background:rgba(32,33,35,0.95); backdrop-filter:blur(10px); position:sticky; top:0; z-index:100;}
.topbar-left { display:flex; align-items:center; gap:16px;}
.toggle { cursor:pointer; padding:8px; font-size:24px; border-radius:8px; display:flex; align-items:center; justify-content:center; transition:0.2s;}
.toggle:hover { background:var(--border);}
.model-select { background:var(--bg-chat); color:var(--text); border:1px solid var(--border); padding:8px 14px; border-radius:8px; cursor:pointer; font-size:14px; font-weight:500; appearance:none; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23ececf1' d='M6 9L1 4h10z'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:right 10px center; padding-right:32px;}
.model-select:hover { border-color:var(--primary);}
.status-indicator { display:flex; align-items:center; gap:8px; font-size:13px; color:var(--text-secondary);}
.status-dot { width:8px; height:8px; border-radius:50%; background:var(--primary); animation:pulse 2s ease-in-out infinite;}
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:0.5;}}

/* Chat area */
.chat { flex:1; overflow-y:auto; padding:20px; display:flex; flex-direction:column; gap:16px; scroll-behavior:smooth;}
.chat::-webkit-scrollbar { width:8px;} .chat::-webkit-scrollbar-thumb { background:var(--border); border-radius:4px;}
.message-wrapper { display:flex; gap:16px; animation:messageSlideIn 0.4s ease; opacity:1;}
@keyframes messageSlideIn {0%{transform:translateY(20px);opacity:0;}100%{transform:translateY(0);opacity:1;}}
.message { background:var(--bg-chat); padding:12px 16px; border-radius:12px; max-width:70%; }

.chat-input { display:flex; padding:12px; border-top:1px solid var(--border); gap:8px; }
.chat-input input { flex:1; padding:10px; border-radius:8px; border:1px solid var(--border); background:var(--bg-chat); color:var(--text); }
.chat-input button { padding:10px 16px; border:none; border-radius:8px; background:var(--primary); color:#fff; font-weight:600; cursor:pointer; transition:0.2s; }
.chat-input button:hover { background:var(--primary-hover);}
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
  <div class="sidebar-header"><span class="logo">AI Chat</span></div>
  <div class="new-chat">+ New Chat</div>
  <div class="history"></div>
</div>

<!-- Main -->
<div class="main">
  <div class="topbar">
    <div class="topbar-left">
      <div class="toggle">&#9776;</div>
      <select class="model-select"><option>Dolphin-Mistral-24B</option></select>
    </div>
    <div class="status-indicator"><span class="status-dot"></span> Online</div>
  </div>

  <div class="chat" id="chat"></div>

  <div class="chat-input">
    <input type="text" id="userInput" placeholder="Type a message...">
    <button id="sendBtn">Send</button>
  </div>
</div>

<script>
// Sidebar toggle
const sidebar = document.querySelector('.sidebar');
const main = document.querySelector('.main');
document.querySelector('.toggle').addEventListener('click', () => {
  sidebar.classList.toggle('collapsed');
  main.classList.toggle('sidebar-collapsed');
});

// Clear chat
document.querySelector('.new-chat').addEventListener('click', () => {
  document.getElementById('chat').innerHTML = '';
});

// Send message to Puter AI
const chat = document.getElementById('chat');
const input = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');

async function sendMessage() {
  const text = input.value.trim();
  if (!text) return;

  // Display user message
  const userMsg = document.createElement('div');
  userMsg.classList.add('message-wrapper');
  userMsg.innerHTML = `<div class="message">You: ${text}</div>`;
  chat.appendChild(userMsg);
  chat.scrollTop = chat.scrollHeight;
  input.value = '';

  try {
    if (!window.puter || !puter.ai) throw new Error("Puter not loaded");

    // Real Puter chat call (no API key needed)
    const response = await puter.ai.chat(text, {
      model: "cognitivecomputations/dolphin-mistral-24b-venice-edition:free"
    });

    const aiMsg = document.createElement('div');
    aiMsg.classList.add('message-wrapper');
    aiMsg.innerHTML = `<div class="message">AI: ${response.message.content}</div>`;
    chat.appendChild(aiMsg);
    chat.scrollTop = chat.scrollHeight;

  } catch (err) {
    console.error(err);
    const aiMsg = document.createElement('div');
    aiMsg.classList.add('message-wrapper');
    aiMsg.innerHTML = `<div class="message">AI: Sorry, something went wrong.</div>`;
    chat.appendChild(aiMsg);
    chat.scrollTop = chat.scrollHeight;
  }
}

sendBtn.addEventListener('click', sendMessage);
input.addEventListener('keypress', (e) => { if(e.key==='Enter') sendMessage(); });
</script>

</body>
</html>